$AppName = "RobloxSkyManager"
$InstallDir = Join-Path $env:LOCALAPPDATA $AppName
$ScriptPath = Join-Path $InstallDir "Main.ps1"
$GithubURL = "https://raw.githubusercontent.com/crazy-invader135/Roblox-Auto-Custom-Skybox/main/Main.ps1"

Write-Host "Installing Roblox Sky Manager with Auto-Update..." -ForegroundColor Cyan

if (-not (Test-Path $InstallDir)) { New-Item -Path $InstallDir -ItemType Directory }

# Download the script
Invoke-WebRequest -Uri $GithubURL -OutFile $ScriptPath

# Create Start Menu Shortcut
$WshShell = New-Object -ComObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$env:APPDATA\Microsoft\Windows\Start Menu\Programs\$AppName.lnk")
$Shortcut.TargetPath = "powershell.exe"
$Shortcut.Arguments = "-ExecutionPolicy Bypass -WindowStyle Hidden -File ""$ScriptPath"""
$Shortcut.WorkingDirectory = $InstallDir
$Shortcut.Save()

Write-Host "Done! Your app will now stay updated via GitHub." -ForegroundColor Green
